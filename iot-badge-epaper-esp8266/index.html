<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.57549d926a8ce7aa67e3.css">body,html{margin:0;padding:0}*{margin-top:0}body.light{--primary-color:#381696;--primary-text-color:#fff;--featured-bg:#493b8a;--secondary-color:#10072b;--background:#fff;--card-bg:#fff;--card-bdr:#eee;--card-shadow:#d5d5d5;--contact-bg:#f7f8fe;--contact-bdr:#d3d6e7;--input-bg:var(--background)}body.dark,body.light{--featured-text:#fff;--site-header:var(--background);--btn-bg:var(--background);--btn-bdr:#d3d6e7;--btn-text-color:#868892;--btn-hover-bg:var(--btn-bdr);--btn-hover-text-color:#00062b}body.dark{--primary-color:#9984d5;--primary-text-color:#fff;--featured-bg:#66578d;--secondary-color:#66578d;--background:#0a041a;--text-color:hsla(0,0%,100%,0.88);--text-secondary-color:hsla(0,0%,100%,0.66);--card-bg:#181326;--card-bdr:#181326;--card-shadow:#020204;--contact-bg:var(--card-shadow);--contact-bdr:var(--card-bg);--input-bg:var(--card-bg)}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif;border-top:10px solid var(--primary-color);background-color:var(--background);color:var(--text-color)}a{color:var(--primary-color);text-decoration:none}a:hover{text-decoration:underline}.site-wrapper{padding:32px;max-width:1140px;margin:0 auto}.site-wrapper img{max-width:100%}.navigation{display:flex;align-items:center;font-weight:300}.navigation a{color:#888;text-decoration:none;margin:0 8px}.navigation a[aria-current]{color:var(--primary-color);font-weight:700}.navigation a:hover{color:var(--primary-color)}.navigation a:last-child{margin-right:0}.site-header{display:flex;justify-content:space-between;padding:20px 0;background:var(--site-header);margin-bottom:32px;align-items:center}.site-title a{color:var(--primary-color);text-decoration:none;font-weight:900;text-transform:uppercase}.hero-header{padding:0 0 64px;max-width:980px}.headline{font-size:36px;font-weight:900;margin-bottom:.5rem}.button{padding:18px 27px;display:inline-block;background:var(--btn-bg);border:1px solid var(--btn-bdr);border-radius:9px;text-decoration:none;color:var(--btn-text-color);font-size:16px;font-weight:400;margin:0 20px 0 0;transition:background-color .3s linear}.button.-primary{background-color:var(--primary-color);border-color:var(--primary-color);color:var(--primary-text-color)}.button.-primary:hover{background-color:var(--secondary-color);color:var(--primary-text-color);text-decoration:none}.button:hover{background-color:var(--btn-hover-bg);color:var(--btn-hover-text-color)}.primary-content{font-size:18px;margin-bottom:32px;line-height:1.5;font-weight:300}.post{padding:0;background:var(--background);color:var(--text-color);line-height:1.5}.post>.blog-post-content{max-width:768px;margin:0 auto}.post>.blog-post-content :last-child,.post>:last-child{margin-bottom:0}.post .post-title{text-align:center;margin:0 0 .5rem;line-height:1.3;font-size:2rem}.post .post-meta{margin-bottom:32px;text-align:center}.post-thumbnail{text-align:center;min-height:380px;background-color:var(--featured-bg);background-repeat:no-repeat;background-size:cover;background-position:50%;border-radius:18px;margin-bottom:36px;color:var(--featured-text);display:grid;align-content:center;position:relative;padding:18px;overflow:hidden}.post-thumbnail:before{content:"";background:rgba(0,0,0,.4);position:absolute;top:0;left:0;width:100%;height:100%;z-index:1}.post-thumbnail>*{position:relative;z-index:2}.post-thumbnail .post-meta{color:hsla(0,0%,100%,.8);margin-bottom:0}.grids{display:grid;grid-template-columns:1fr;grid-gap:32px;margin-top:32px}.card{display:grid;background-color:var(--card-bg);border-radius:9px;border:1px solid var(--card-bdr);box-shadow:0 0 30px var(--card-shadow);overflow:hidden;line-height:1.5}.card:hover .post-link{color:var(--primary-color)}.card>a img{display:block}.card>header{padding:24px}.card>h2:first-child{margin:0 0 .5rem}.card .post-title{font-size:1.2rem;margin-bottom:.3rem}.card .post-meta{font-weight:100;margin-bottom:0}.card .post-link{color:var(--text-color);text-decoration:none}.post-meta{font-size:.8rem;color:var(--text-secondary-color)}.site-footer{text-align:center;margin:90px 0 16px;color:#666}.site-footer a{font-weight:700}.form-container{background-color:var(--contact-bg);padding:32px;border:1px solid var(--contact-bdr);border-radius:9px}.form-container label{display:block;margin-bottom:.5rem;color:var(--text-secondary-color)}.form-container input[type=email],.form-container input[type=text],.form-container textarea{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:1px solid var(--card-shadow);color:var(--text-secondary-color);border-radius:6px;line-height:32px;padding:6px 12px;width:calc(100% - 24px);margin-bottom:1.5rem;background-color:var(--input-bg);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.form-container textarea{margin-bottom:2rem;height:150px}.two-grids{display:grid;grid-gap:32px}.two-grids.-contact .post-thumbnail{min-height:240px!important}@media only screen and (min-width:768px){.grids{grid-template-columns:1fr 1fr}}@media only screen and (min-width:1024px){.grids{grid-template-columns:1fr 1fr 1fr}.two-grids{display:grid;grid-template-columns:1fr 1fr;grid-gap:64px}}.theme-changer,body.dark .gg-moon,body.light .gg-sun{display:none}.mode-container{width:24px;height:24px;margin-left:20px}.gg-sun{position:relative;transform:scale(var(--ggs,1));height:24px;background:linear-gradient(180deg,currentColor 4px,transparent 0) no-repeat 5px -6px/2px 6px,linear-gradient(180deg,currentColor 4px,transparent 0) no-repeat 5px 14px/2px 6px,linear-gradient(180deg,currentColor 4px,transparent 0) no-repeat -8px 5px/6px 2px,linear-gradient(180deg,currentColor 4px,transparent 0) no-repeat 14px 5px/6px 2px;border-radius:100px;box-shadow:inset 0 0 0 2px;border:6px solid transparent}.gg-sun,.gg-sun:after,.gg-sun:before{box-sizing:border-box;display:block;width:24px}.gg-sun:after,.gg-sun:before{content:"";position:absolute;height:2px;border-right:4px solid;border-left:4px solid;left:-6px;top:5px}.gg-sun:before{transform:rotate(-45deg)}.gg-sun:after{transform:rotate(45deg)}.gg-moon,.gg-moon:after{display:block;box-sizing:border-box;border-radius:50%}.gg-moon{overflow:hidden;position:relative;transform:rotate(-135deg) scale(var(--ggs,1));width:20px;height:20px;border:2px solid;border-bottom:2px solid transparent}.gg-moon:after{content:"";position:absolute;width:12px;height:18px;border:2px solid transparent;box-shadow:0 0 0 2px;top:8px;left:2px}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.21.0"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-194172322-1', 'auto', {});
      
      
      
      
      
      }</script><link rel="icon" href="/favicon-32x32.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#381696"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9eda4e53e4f02d1c4da2a9b1f0532b92"/><title data-react-helmet="true">Building an IoT badge with ESP8266 + E-Paper | mnkytypwrtr</title><meta data-react-helmet="true" name="description" content="Building an IoT badge with ESP8266 + E-Paper"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link as="script" rel="preload" href="/webpack-runtime-a1ac211d5c079ae5a70c.js"/><link as="script" rel="preload" href="/framework-82cb02c7461ef249f4f8.js"/><link as="script" rel="preload" href="/532a2f07-4b81c8a9332f9eace879.js"/><link as="script" rel="preload" href="/app-22f6e56c3e101bab3555.js"/><link as="script" rel="preload" href="/styles-b8a088968a9324807caf.js"/><link as="script" rel="preload" href="/b34906bb45276341108473925e234e3fd24b49e8-9196865742c1b9e57a7e.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-b176f0b3b6ca3aa5087e.js"/><link as="fetch" rel="preload" href="/page-data/iot-badge-epaper-esp8266/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="site-wrapper"><header class="site-header"><div class="site-title"><a href="/">mnkytypwrtr</a></div><nav class="navigation"><a href="https://twitter.com/mnkytypwrtr" target="_blank">Twitter</a><label><input type="checkbox" class="theme-changer"/> <div class="mode-container"><i class="gg-sun"></i><i class="gg-moon"></i></div></label></nav></header><div class="blog-post-container"><article class="post"><div class="post-thumbnail" style="background-image:url(/assets/2017-12-29-iot-badge-epaper-esp8266/thumbnail.jpg)"><h1 class="post-title">Building an IoT badge with ESP8266 + E-Paper</h1><div class="post-meta">December 29, 2017</div></div><div class="blog-post-content"><blockquote>
<p><strong><em>Hello, my name is badgy! I’m an E-Paper IoT badge with a 5-way joystick!</em></strong></p>
</blockquote>
<p>I’ve recently come across some e-paper display modules and thought they were the coolest thing ever. For those not familiar with e-paper, it’s a display technology similar to what’s used in e-readers (such as the Amazon Kindle).</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/epaper.gif"><figcaption>How E-Paper Works</figcaption></figure></p>
<p>These displays don’t require any power to stay on, it’s only when you need to update the image do you need to give it power. The image on the left shows a high-level concept diagram of how these displays work.</p>
<p>For battery powered IoT devices, there are many advantages to using these type of displays; you can pretty much shut off everything to preserve battery life and wake up only when you need to perform some action, all while displaying pertinent information to the user.</p>
<p>So what can you do with an ESP8266, a battery, some buttons, and an E-Paper display?</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/iot-remote.jpg" title="E-Paper IoT Remote"><figcaption>1. Smart Home Remote (Note the 5-way switch, up/down/left/right/center)</figcaption></figure></p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/weather.jpg" title="Weather Dashboard"><figcaption>2. Weather Dashboard</figcaption></figure></p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/wifi-manager.jpg" title="Wi-Fi Manager"><figcaption>3. Wi-Fi Manager</figcaption></figure></p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/notifications.jpg" title="Display Notifications"><figcaption>4. Display Notifications (IFTTT or other integrations)</figcaption></figure></p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/name-tag.jpg" title="Name Tag"><figcaption>5. Name Tag</figcaption></figure></p>
<p>…and pretty much anything you can think of. It’s a tiny battery powered computer with WiFi connectivity!</p>
<h2>Building the badge</h2>
<p>These e-paper displays support the SPI protocol, so you’ll need to connect the right wires to the right pins on your microcontroller (the ESP8266 in our case) to drive the display. The display also requires a driving circuit to work, of which you can either get an adapter board for , or build your own. I decided on the latter, as the documentation was sufficient, and I didn’t want messy wires.</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/driver-circuit.png" title="Driver Circuit"><figcaption>bunch of diodes, mosfets, and capacitors</figcaption></figure></p>
<p>As with many of my recent projects, I usually skip the breadboarding phase and jump straight to designing the PCB on <a href="https://kicad.org/">KiCad</a> (hurrrray for open source software!). While building the driver circuit, I also threw in a coin cell battery + USB charger to make our little badge portable.</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/schematic.png" title="KiCad Schematic"><figcaption>KiCad Schematic</figcaption></figure></p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/pcb-render.jpg" title="PCB Render"><figcaption>The badge itself is barely larger than the display :)</figcaption></figure></p>
<p>After double/triple/quadruple checking everything, I sent the design off to a PCB fab to have the boards made…</p>
<p>The datasheet also thoroughly describes the timing and signals over SPI on how to control the display, but luckily for us, GitHub user <a href="https://github.com/ZinggJM">ZinggJM</a> created an Arduino library that abstracts all of that away :)</p>
<p><a href="https://github.com/ZinggJM/GxEPD">https://github.com/ZinggJM/GxEPD</a></p>
<p>It also leverages the Adafruit-GFX library, so you can use graphics primitives to do your drawing and rendering of images/text.</p>
<br>
<hr>
<br>
<p>After 5 long days, the boards finally arrived!</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/badgy-pcb.jpg" title="Badgy PCBs!"><figcaption>Badgy PCBs!</figcaption></figure></p>
<p>I used 0805 footprints for most of the components so they’re easier to hand solder, though there was no getting away with the 24 pin FPC connector (drag soldering did the trick)</p>
<p><figure class="md-figure"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/assembled-badgy.jpg" title="Assembled Badgy"><figcaption>Yay it works! Charging up the Li-Ion LIR2450 coin cell battery</figcaption></figure></p>
<p>Notice the empty pin headers on J1; these are connected to the TX/RX/GPIO0 pins of the ESP8266 and used for programming the chip with a USB-Serial adapter. You can either solder on pin headers and have a permanent programming connector, or you can do what I did and simply pushed pins against the pads to load the OTA firmware once, then you could always upload any new sketches over WiFi (as long as the new sketch doesn’t crash/fail).</p>
<br>
<hr>
<br>
<p>Right now, I’m doing some real world tests on battery life, but based on my calculations I should get about 40 days of battery life in deep sleep mode:</p>
<p>120 mAh coin cell battery / (60uA regulator + 20uA deepsleep ESP8266) x 0.70 miscellaneous factors = 1050 hours ~= 43 days</p>
<p>Switching up the battery technology may also extend this a bit further; a 500 mAh LiPo has a similar footprint, and should theoretically offer a 4X battery life.</p>
<br>
<hr>
<br>
<p>All source files are available on <a href="https://github.com/sqfmi/badgy">GitHub</a>, feel free to contribute and build your own! If you want to support Badgy, you can get one today on Tindie. Enjoy :)</p>
<p><a href="https://www.tindie.com/products/edit/badgy-iot-badge/"><img src="/assets/2017-12-29-iot-badge-epaper-esp8266/tindie.png"></a></p></div></article></div><footer class="site-footer"><p>© <!-- -->2022<!-- --> Monkey Typewriter • Made with <span role="img" aria-label="love">❤️</span> in NYC</p></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/iot-badge-epaper-esp8266";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-22f6e56c3e101bab3555.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-f43775200c27a0bf4ae1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e23b2f8df8c57dff18b8.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-9c99671699ee8a5c0a16.js"],"component---src-pages-index-js":["/component---src-pages-index-js-c9f4ff8f52283b092b54.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-b176f0b3b6ca3aa5087e.js"]};/*]]>*/</script><script src="/component---src-templates-blog-template-js-b176f0b3b6ca3aa5087e.js" async=""></script><script src="/b34906bb45276341108473925e234e3fd24b49e8-9196865742c1b9e57a7e.js" async=""></script><script src="/styles-b8a088968a9324807caf.js" async=""></script><script src="/app-22f6e56c3e101bab3555.js" async=""></script><script src="/532a2f07-4b81c8a9332f9eace879.js" async=""></script><script src="/framework-82cb02c7461ef249f4f8.js" async=""></script><script src="/webpack-runtime-a1ac211d5c079ae5a70c.js" async=""></script></body></html>